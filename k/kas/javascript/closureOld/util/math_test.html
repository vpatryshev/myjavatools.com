<!DOCTYPE html>

<!--
Copyright 2006 Google Inc.
 All Rights Reserved.
-->

<html>
<head>
<title>goog.math Tests</title>
<script type="text/javascript" src="../../../third_party/java/jsunit/jsunit2.2/app/jsUnitCore.js"></script>
<script type="text/javascript" src="../base.js"></script>
<script type="text/javascript">
  goog.require('goog.math');
  goog.require('goog.array');
</script>
</head>
<body>

<script type="text/javascript">

  goog.globalize(goog);
  goog.globalize(goog.math);


  function testSize1() {
    var dim1 = new Size();
    assertUndefined(dim1.width);
    assertUndefined(dim1.height);
    assertEquals('(undefined x undefined)', dim1.toString());
  }

  function testSize2() {
    var dim2 = new Size(10);
    assertEquals(10, dim2.width);
    assertUndefined(dim2.height);
    assertEquals('(10 x undefined)', dim2.toString());
  }

  function testSize3() {
    var dim3 = new Size(10, 20);
    assertEquals(10, dim3.width);
    assertEquals(20, dim3.height);
    assertEquals('(10 x 20)', dim3.toString());
  }

  function testSize4() {
    var dim4 = new Size(10.5, 20.897);
    assertEquals(10.5, dim4.width);
    assertEquals(20.897, dim4.height);
    assertEquals('(10.5 x 20.897)', dim4.toString());
  }

  function testSize5() {
    var dim5 = new Size('ten', 1000);
    assertTrue(isNaN(dim5.width));
    assertEquals(1000, dim5.height);
    assertEquals('(NaN x 1000)', dim5.toString());
  }

  function testSize6() {
    var dim6 = new Size('ten', {woop: 'test'});
    assertTrue(isNaN(dim6.width));
    assertTrue(isNaN(dim6.height));
    assertEquals('(NaN x NaN)', dim6.toString());

  }

  function testSize7() {
    var dim7 = new Size(0, 0);
    assertEquals(0, dim7.width);
    assertEquals(0, dim7.height);
    assertEquals('(0 x 0)', dim7.toString());
  }



  function testCoordinate1() {
    var dim1 = new Coordinate();
    assertUndefined(dim1.x);
    assertUndefined(dim1.y);
    assertEquals('(undefined, undefined)', dim1.toString());
  }

  function testCoordinate2() {
    var dim2 = new Coordinate(10);
    assertEquals(10, dim2.x);
    assertUndefined(dim2.y);
    assertEquals('(10, undefined)', dim2.toString());
  }

  function testCoordinate3() {
    var dim3 = new Coordinate(10, 20);
    assertEquals(10, dim3.x);
    assertEquals(20, dim3.y);
    assertEquals('(10, 20)', dim3.toString());
  }

  function testCoordinate4() {
    var dim4 = new Coordinate(10.5, 20.897);
    assertEquals(10.5, dim4.x);
    assertEquals(20.897, dim4.y);
    assertEquals('(10.5, 20.897)', dim4.toString());
  }

  function testCoordinate5() {
    var dim5 = new Coordinate('ten', 1000);
    assertTrue(isNaN(dim5.x));
    assertEquals(1000, dim5.y);
    assertEquals('(NaN, 1000)', dim5.toString());
  }

  function testCoordinate6() {
    var dim6 = new Coordinate('ten', {woop: 'test'});
    assertTrue(isNaN(dim6.x));
    assertTrue(isNaN(dim6.y));
    assertEquals('(NaN, NaN)', dim6.toString());
  }

  function testCoordinate7() {
    var dim7 = new Coordinate(0, 0);
    assertEquals(0, dim7.x);
    assertEquals(0, dim7.y);
    assertEquals('(0, 0)', dim7.toString());
  }

  // range tests

  function assertRangesEqual(expected, actual) {
    assertTrue(goog.math.Range.equals(expected, actual));
  }
  
  function createRange(a) {
    return a ? new goog.math.Range(a[0], a[1]) : null;
  }
  
  function testIntersection() {
    var tests = [[[1, 2], [3, 4], null],
                 [[1, 3], [2, 4], [2, 3]],
                 [[1, 4], [2, 3], [2, 3]],
                 [[-1, 2], [-1, 2], [-1, 2]],
                 [[1, 2], [2, 3], [2, 2]],
                 [[1, 1], [1, 1], [1, 1]]];
    for (var i = 0; i < tests.length; ++i) {
      var t = tests[i];
      var r0 = createRange(t[0]);
      var r1 = createRange(t[1]);
      var expected = createRange(t[2]);
      assertRangesEqual(expected, goog.math.Range.intersection(r0, r1));
      assertRangesEqual(expected, goog.math.Range.intersection(r1, r0));
    }
  }

  function testBoundingRange() {
    var tests = [[[1, 2], [3, 4], [1, 4]],
                 [[1, 3], [2, 4], [1, 4]],
                 [[1, 4], [2, 3], [1, 4]],
                 [[-1, 2], [-1, 2], [-1, 2]],
                 [[1, 2], [2, 3], [1, 3]],
                 [[1, 1], [1, 1], [1, 1]]];
    for (var i = 0; i < tests.length; ++i) {
      var t = tests[i];
      var r0 = createRange(t[0]);
      var r1 = createRange(t[1]);
      var expected = createRange(t[2]);
      assertRangesEqual(expected, goog.math.Range.boundingRange(r0, r1));
      assertRangesEqual(expected, goog.math.Range.boundingRange(r1, r0));
    }
  }

  // rect tests

  function assertRectsEqual(expected, actual) {
    assertTrue(goog.math.Rect.equals(expected, actual));
  }

  function createRect(a) {
    return a ? new goog.math.Rect(a[0], a[1], a[2] - a[0], a[3] - a[1]) : null;
  }

  function testRectIntersection() {
    var tests = [[[10, 10, 20, 20], [15, 15, 25, 25], [15, 15, 20, 20]],
                 [[10, 10, 20, 20], [20, 0, 30, 10], [20, 10, 20, 10]],
                 [[0, 0, 1, 1], [10, 11, 12, 13], null],
                 [[11, 12, 98, 99], [22, 23, 34, 35], [22, 23, 34, 35]]];
    for (var i = 0; i < tests.length; ++i) {
      var t = tests[i];
      var r0 = createRect(t[0]);
      var r1 = createRect(t[1]);
      var expected = createRect(t[2]);
      assertRectsEqual(expected, goog.math.Rect.intersection(r0, r1));
      assertRectsEqual(expected, goog.math.Rect.intersection(r1, r0));
    }
  }

  function testRectBoundingRect() {
    var tests = [[[10, 10, 20, 20], [15, 15, 25, 25], [10, 10, 25, 25]],
                 [[10, 10, 20, 20], [20, 0, 30, 10], [10, 0, 30, 20]],
                 [[0, 0, 1, 1], [10, 11, 12, 13], [0, 0, 12, 13]],
                 [[11, 12, 98, 99], [22, 23, 34, 35], [11, 12, 98, 99]]];
    for (var i = 0; i < tests.length; ++i) {
      var t = tests[i];
      var r0 = createRect(t[0]);
      var r1 = createRect(t[1]);
      var expected = createRect(t[2]);
      assertRectsEqual(expected, goog.math.Rect.boundingRect(r0, r1));
      assertRectsEqual(expected, goog.math.Rect.boundingRect(r1, r0));
    }
  }

</script>
</body>
</html>
